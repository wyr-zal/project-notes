# 全局异常统一处理（CommonExceptionAdvice）

## 1️⃣ 组件定位

- 模块位置：`common` 公共模块
- 类名：`CommonExceptionAdvice`
- 技术点：
  - `@RestControllerAdvice`
  - `@ExceptionHandler`
  - 统一响应封装
  - 异常分层设计

> 这是一个 **Controller 层的全局异常兜底组件**

---

## 2️⃣ 解决了什么问题？

### 如果没有它
- Controller 抛异常 → 前端直接 500
- 堆栈信息暴露，存在安全风险
- 不同接口返回结构不一致
- 异常处理逻辑分散在各个 Controller

### 有了它之后
- 所有异常统一处理
- 前端永远收到统一结构 `R`
- 异常分类清晰，便于排查
- Controller 只关心业务逻辑

---

## 3️⃣ 生效范围 & 执行时机

### 生效范围
- 当前 Spring Boot 应用
- 所有 `@RestController`

### 执行时机（重点）
```text
请求进入 Controller
        ↓
Controller 方法执行
        ↓
发生异常 ❌
        ↓
CommonExceptionAdvice 捕获
        ↓
返回统一 JSON 响应
```

## 4️⃣ 最小完整示例（能直接跑）

```java
@RestControllerAdvice
public class GlobalExceptionAdvice {

    @ExceptionHandler(Exception.class)
    public String handleException(Exception e) {
        return "服务器异常";
    }
}

```